#!/bin/bash

NOTES_DIR="$HOME/.notes"
NOTES="$NOTES_DIR/index.md"

mkdir -p "$NOTES_DIR"
cd "$NOTES_DIR" || exit 

if [ -t 0 ] && [ "$#" -eq 0 ]; then
	server_pid=$!
	if [ -r "$NOTES" ]; then
		tmux-pane vim -o "$NOTES" -c "call Notes()" -c "au VimLeave * :call system('kill ' . $server_pid)"
	else 
		echo "$NOTES: No such file or directory"
	fi
else 
	exec cat >> "$NOTES"
fi
